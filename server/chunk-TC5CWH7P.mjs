import './polyfills.server.mjs';
import{A as o,D as l,F as u,G as m,c as s,n as a,y as n}from"./chunk-ZPTDKJIY.mjs";var h=new u("TIMEOUT_CONFIG"),c=class{createTimeoutService(e){return new d(e)}};var d=(()=>{let e=class e{get idleLimit(){return this._idleLimit}get idleWarning(){return this._idleWarning}get tempConfig(){return this._tempConfig}constructor(t){this.config=t,this.accumulatedSec=0,this._defaultIdleLimit=60*10,this._defaultIdleWarning=20,this.afk$=new s,this.pauseTimer$=new s,this.isTimeout$=new s,this.isTimeWarning$=new s,this._idleLimit=t?.idleLimit||this._defaultIdleLimit,this._idleWarning=t?.idleWarning||this._defaultIdleWarning}getAfk$(){return this.afk$.asObservable()}getIsTimeout$(){return this.isTimeout$.asObservable()}getIsTimeWarning$(){return this.isTimeWarning$.asObservable()}startTimer(){this.startCounting()}startCounting(){console.log("[Countdown startCounting: startCounting!]",this.timer$),this.timer$?(console.log("[Countdown startCounting: this.timer$ clearTimer()]"),this.clearTimer()):(console.log("[Countdown startCounting: this.timer$.subscribe()]"),this.timer$=this.setTimer$().subscribe())}setTimer$(){return console.log("[Countdown setTimer$]"),a(1e3).pipe(n(this.isTimeout$),n(this.pauseTimer$),this.calcSec())}calcSec(){return console.log("[Countdown calcSec]"),o(t=>{this.accumulatedSec+=1,this.afk$.next(this.accumulatedSec),this.checkIsTimeout(this.accumulatedSec,this._idleLimit)})}checkIsTimeout(t,i){return console.log("[Countdown checkIsTimeout]: ",[t,this._idleWarning,i]),t>=i?(this.isTimeout$.next(!0),this.accumulatedSec=0,!0):(i-t===this._idleWarning&&this.isTimeWarning$.next(!0),!1)}pauseTimer(){console.log("[Countdown pauseTimer]"),this._tempConfig={idleLimit:this.idleLimit,idleWarning:this.idleWarning,accumulatedSec:this.accumulatedSec},this.pauseTimer$.next(!0)}restartTimer(){this.resetTimer(this._tempConfig)}resetTimer(t){this.clearTimer(),console.log("[Countdown resetTimer config: ]",[t,this.accumulatedSec]),t&&(this.setTimeoutConfig(t),this.accumulatedSec=t?.accumulatedSec||0),this.startTimer()}clearTimer(){console.log("[Countdown clearTimer: clear!]"),this.timer$&&(this.timer$.unsubscribe(),this.timer$=null),this.accumulatedSec=0}setTimeoutConfig(t){this._idleLimit=t.idleLimit||this._defaultIdleLimit,this._idleWarning=t.idleWarning||this._defaultIdleWarning}};e.\u0275fac=function(i){return new(i||e)(m(h))},e.\u0275prov=l({token:e,factory:e.\u0275fac});let r=e;return r})();export{h as a,c as b,d as c};
